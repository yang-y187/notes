问题梳理

自我介绍不熟悉，一直啊啊啊，不要一直说一定一定

- 离职的原因
  - 上班地点不合适，女朋友在海淀上班，我在亦庄
  - 收入和付出不成正比
- 到岗需要多久
  - 十天半个月就可
- ArrayList和LinkedList的区别
- 添加和删除操作比较频繁的时候选择哪个list   
  - 添加和删除都比较频繁的情况下，选择LinkedList
- 线程异步的方式
- runable和callback异步方式的区别
- 为什么线程Thread可以通过继承的方式执行，为什么还需要存在实现runable接口实现类的方式呢
  - 没答好，真正答案是
    - Java是单继承，一个类只能继承一个父类，限制了代码的灵活，而实现runable接口没有这个限制
    - 实现runable接口可以将线程逻辑和线程对象分离，使代码更加容易复用
    - 线程池只支持runable task任务
- 现成start方法和run方法
- 线程执行run方法时，是什么状态
- 线程的状态有哪几种 
  - 新建、就绪、阻塞、等待、超时等待、终止
- 线程执行sleep会进入哪种状态
- 线程安全问题是什么问题
- 怎么解决线程安全问题
- syn和volatile的区别
- 有什么实际使用场景
  - 招商系统 取类目信息
- jvm内存区域有哪些
- 什么情况下使用直接内存
  - NIO和零拷贝会用到
- 方法区和直接内存不是两个东西吗，为什么方法区放在直接内存中
- 说一下零拷贝
- 直接内存怎么释放内存呢 ?
- 堆内存怎么回收
  - 回收算法
  - 标记的算法
- mysql中的脏读和幻读的区别
- 最佳左前缀讲一下
- 将查询三列数据 a，b，c，输出的接口合成1列
- 哨兵节点和分片集群的区别
- 计算机网络中 TCP/IP 模型分为哪几层
- 网络层常见的协议有哪些
- IP协议是哪一层的
- http和https协议的区别
- 非对称加密有性能损耗，有什么优化措施吗
- 中间人劫持怎么解决
- 项目-合同拆分片
  - 一千万数据的单表为什么要进行拆分片呢？
    - 因为门店每年都需要续签合同，门店续签合同会导致合同表的数据量在短时间内激增几百万条，这是一个潜在的风险，不能在极大影响性能的情况下再进行拆分，单分片的性能瓶颈只会越来越明显
    - 多分片提高了系统的可用性
  - 讲一下怎么拆分片的，是否有数据倾斜的问题？
    - 一个分片，290多万，300多万，最多不超过310万
  - 拆分片后，查询怎么处理呢？
- 讲一下 业务监控异常的背景以及怎么设计的
  - 背景：实时发现业务异常的情况、数据库与ES、redis数据不一致的情况、在长时间处于一个状态的监控
  - 实现：接binlog日志的消息，反查数据库，进行校验，判断是否有异常、es、redis不一致等，
    - 怎么接binlog消息的呢？
      - 京东有数据订阅的中间件，阿里也有类似的canal，模拟为数据库的从节点，收到数据变更的消息，则同步订阅方，我们应用订阅了商家、门店、费用、合同表数据
      - 收到数据变更的消息后，再执行先进行逻辑判断，转发到不同的消息队列 （状态停留、数据一致性、业务异常是不同的消息队列，我们需要把它抽离出来）
      - 另外，京东的binlog消息处理如果有异常，会进行阻塞，导致后续所有的消息都无法消费，因此不要在该处做任何业务的处理
      - 
    - 每一种问题都需要添加一段代码来判断吗，这会不会做很复杂，工作量很大
      - 使用了模版模式的设计模式，抽出一个抽象类，将整体的流程写出来，商家、门店、费用等，只需要实现具体的对比方法即可
    - 两千条问题，是发现了两千种问题吗？
      - 不是，是两千条数据有异常，但是不会有重复发送的问题，因为我们有做版本控制
- 项目-ddd 领域驱动设计，讲一讲具体怎么落地的，可以举一个示例
  - 
  - 如何划分领域的？
    - 领域驱动设计（Domain-Driven Design，DDD）是一种软件开发方法论，旨在通过将系统的核心逻辑与业务领域紧密结合，构建出高内聚、低耦合的软件系统。
- 7000万条数据备案迁移 是怎么做的
  - 描述背景：
  - 操作：
  - 问题：开始双写，读新库有问题吧
  - 怎么确定哪些数据是要迁移到归档库呢？
    - 根据业务场景来的
  - 旧表迁移到新表，怎么迁移的呢？
    - 分页查询一条条迁移的，为了避免深度分页，使用了滚动查询
    - 



同花顺

- 主要是做B端业务吗
- 领域驱动介绍下
- 领域驱动 如何分层
- 遇到过OOM的问题吗？ 怎么排查的
- 领域驱动 如何和其他系统交互
- 领域驱动的系统，做了怎样的优化 
  - 系统优化
  - 性能优化
- 合同迁移的过程中，遇到过什么问题吗
- JVM的安全点
- 操作系统中 虚拟内存是干嘛用的
- N对夫妻，2N个位子，有多少种排位方式
- 给你一笔钱x,再给 10支股票，30天，计算出最大收益，假设买入卖出没有成本
- 给一个数字，输出质数的乘积



牵手

- 





**新东方**

- 如果单机器对Controller中某个方法的调用次数进行统计，用哪种Java数据类型
  - 用CurrentHashMap，key是方法，Value 是什么类型：**`AtomicInteger`** 说成AtomicLong了，没有这个类型，或者用LongAddr
  - 不使用map，使用volatile Long 可以吗？
    - 不行，volatile 只保证了单线程的指令重排无异常，不能保证多线程的指令重排
  - AtomicInteger 是如何保证原子性的呢？
    - 使用CAS实现的
- CurrentHashMap1.7  1.8的区别
  - 1.7 是底层结构是 segment数组 + HashEntry数据+链表，segment数据继承了rententLock锁，segment数组创建好后不能再改变，默认是16，HashEntry默认是2，可以扩容
  - 1.8 底层结构是Node数组+链表/红黑树的结构，使用的锁是  syncronized+cas的方式，Node对应一把锁，方便扩容，且懒加载
- CurrentHashMap 1.7 从rententlock 切换到syncronized
- 锁升级，如何升级
- **AQS中的队列是无界的队列，为什么是无界的呢？**
- **如何发现OOM 以及排查定位OOM的问题**
  - 
- **双向链表，某个节点的指针在瞎指，如何发现？**
- 分布式机器，统计某个方法的访问次数，怎么实现？
  - 存redis，存String类型就可
  - 不考虑并发的问题，如何统计访问量前三的接口呢？
    - 用Zset
- Zset 底层数据结构是有两种实现方式吧，怎么实现的？
  - 数据量少于128条，元素大小小于64字节，使用压缩列表，否则使用 跳表+Hash的结构
- 跳表 [2,4,6,8,10]，插入数据5，怎么插入？
  - 跳表是双向链表，需要移动哪个指针
- Mybatis是如何避免sql注入的？
- 讲一下Mybatis的执行流程？
  - 略过了很多东西
- **不同的mapper中，都有getById的方法，可以存在吗，为什么**
- @autowired 讲一下 
- 数据库的默认事务隔离界别是什么？
- @Transactional 讲一下
- **@Transactional 修饰了方法a,a内部调用了方法b，执行完b代码后执行后续逻辑异常了，方法b会回滚吗**
  - 说错了
- union 和union all的区别 
  - 没打出来
- 写一个复杂sql 
  - 没写出来
- 10亿条数据的联合索引树，有几层？
- 数据库有哪些事务隔离级别
- **数据库默认的事务隔离级别是**





快手

- B用户是什么概念，用户主体是哪些
- 为什么要对合同表进行拆分片？
- 某个用户的不同合同组是可能写在不同的分片上的，这你们是怎么解决的？
  - 数据库增加索引、分页复杂查询 查ES
- 怎么保证 ES和数据库中的数据是一致的？
  - 业务监控系统保证我们的一致性
- 业务监控系统 监控的是啥呢？
- 接binlog 消息同步ES和自己发MQ同步ES 的区别是什么，是怎么考虑的？
  - 实时发消
    - 灵活度高，可以在业务逻辑中控制何时发送消息
    - 侵入到业务代码，增加了业务的复杂度
    - 我们消息自产自销，性能高
  - binlog消息
    - 解耦性好
    - 接从库的binlog消息，增加了数据的延迟
- 接binlog消息有延迟，用ES不能忍受这种延迟吗，是有其他的考虑吗？
- 怎么保证 ES 和数据库的一致性的？
  - 发MQ是无序的，怎么保证是先更新A，后更新成B，而不是先更新成B后变成A
- 假设 发现有业务不一致的情况，后续步骤是啥？
- java线程池了解过吗？你认为线程池需要手动的关闭吗？
  - 
- 线程池怎么关闭呢？
- showdownNow 是怎么关闭线程的
- interrupt 一定会停止线程吗？
- 有其他可以粗暴停止线程的方式吗？
  - 没答出来
- redis快在哪？
- redis既然是单线程，为什么既能存储数据，又能设置过期时间清除数据的呢？
- redis 分布式锁 加锁解锁流程是什么?
- 实际应用是怎么判断锁的，分布式锁的锁重试是什么实现的？
- 发起一个RPC调用流程
- 调用方怎么刷新发布者的IP信息呢？
  - 这就开始瞎说了，实际有多种方式
    1. 定期向服务注册中心拉取发布者的IP信息
    2. 监听发布者的变更，有变更会主动拉取
    3. 注册变更后会通知调用方，调用方再拉取刷新
  - 需要说引发布者的包，通过反射创建该对象
- 序列化方式是哪提供的，包里面会提供序列化方式？
- 多个RPC调用，如何区分线程A的调用与结果A对应呢，而不是结果B的
  - 请求时携带请求Id
- 大数相乘







白龙马

- 合同表拆分片是怎么做的？

- 用户要查合同信息怎么办呢？

- 分布式ID是怎么生成的？

- 对业务监控系统，系统梳理总结一下，描述的太细致，太零碎了，分门别类的有些问题、有哪些手段、取得哪些结果

- 业务监控系统是什么系统？技术无异常，但业务异常的监控系统

- 在京东贡献、或者经历对自己印象最深、或者成长最大的

- 对数据库 索引 的理解，有哪些使用上的经验吗

- 一次查询可以用到多个索引，mysql查询的过程？

- 单表查询可以命中多个索引吗？

  - 条件 a=x, b=x   ，有a索引和b索引，index merge 

- 联合查询。范围查询有什么影响吗

- explan 中 key_lens 什么含义 命中索引的字段长度 

- explan 用到哪些字段

  - possible_keys、key、Extra 用的比较多

- Extra 哪些字段解释下

- using index 和 using index condition 含义

- 还有哪些没体现你的技术深度？

  - 叶子节点的内部

- B+树写入过程是怎么样的

- 有20g的文件内容，需要排序，只有一台8g的电脑 怎么排序

  - 将数据分为10个文件，然后读取每个数据的第一行（最小数据），得出最小的数据写入新的文件，然后再从最小数据所在的文件中读取一行数据，反复执行，得出所有排好序的数据

  



最右

- 用户中台的业务背景，技术上的挑战是什么，是怎么处理这些问题的
- 合同表拆分片，如何拆的
- 分片键是选择的
- 为什么要拆分片？1000万的数据量并不大
- 拆完分片后的收益是什么？
- 业务监控系统 做了什么？
- 提交审批流，审批流应该能够判断出来是否配置了审核人吧，直接repense 返回不行吗？
- 介绍下ddd
- 通用审核平台 是怎么做的？
  1. 原ES索引A，新增一个ES索引B，迁移数据时，同一类型、门店下审核完结的审核单只保留一条 （开启双写）
     - 存量数据：写脚本迁移
     - 增量数据：审核单完成或者驳回发的mq 自产自消，查当前门店下历史的审核单，只保留当前条，其他数据迁移到新ES 索引中
  2. 开始数据的全量对比
  3. 页面区分 归档库和未归档库 （关闭双写）
  4. 无异常后，将旧ES索引中的数据清除，自产自消时，将旧ES库中的数据清除 
  5. 如果数据有异常的情况下，通过数据库中的数据，将所有数据进行补偿
- 讲一下日常 遇到的索引优化
- redis的优点
- redis 的Recator 模式了解吗
- redis 中IO多路复用用的哪种方式
- epoll 为什么更快
- epoll 中 et 和lt的区别
- redis 用的哪种 ？
- 一个背包问题，选择不同的硬币数组，组合成指定数额的最少硬币数





美团

- volatile关键字 讲一下
- 